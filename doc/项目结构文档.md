# n8n 项目结构文档

## 项目概述

n8n 是一个开源的工作流自动化平台，允许用户通过可视化界面连接不同的服务和数据源，实现业务流程自动化。这是一个 monorepo 项目，使用 pnpm 和 turbo 构建系统。

## 根目录结构

- `AGENTS.md`: AI Agent 相关文档
- `CHANGELOG.md`: 项目变更日志
- `CLAUDE.md`: Claude 相关文档
- `CONTRIBUTING.md`: 贡献指南
- `LICENSE.md`: 开源许可协议
- `README.md`: 项目介绍文档
- `biome.jsonc`: Biome 代码格式化工具配置
- `docker/`: Docker 相关配置和镜像构建文件
- `docker/images/n8n/`: n8n Docker 镜像配置
- `docker/images/n8n-base/`: n8n 基础镜像配置
- `docker/images/runners/`: 任务运行器镜像配置
- `packages/`: 主要代码包目录
- `scripts/`: 构建和管理脚本
- `shell/`: Windows 批处理脚本和 PowerShell 脚本
- `patches/`: 用于修复依赖包问题的补丁文件
- `turbo.json`: Turbo 构建工具配置
- `pnpm-workspace.yaml`: pnpm 工作区配置

## packages 目录结构

### 主要应用模块

#### `cli/`
- **功能**: n8n 的命令行接口，包含主服务启动逻辑
- **主要文件**:
  - `src/index.ts`: 应用入口点
  - `src/commands/`: 各种命令实现（如启动、停止、导出等）
  - `src/controllers/`: HTTP 控制器
  - `src/services/`: 核心服务类
  - `src/auth/`: 认证和授权逻辑
  - `src/user-management/`: 用户管理功能

#### `core/`
- **功能**: n8n 的核心功能库
- **主要文件**:
  - `src/`: 核心抽象和通用功能
  - `nodes-testing/`: 节点测试工具

#### `workflow/`
- **功能**: 工作流处理和执行引擎
- **主要文件**:
  - `src/`: 工作流定义、表达式解析、节点类型定义等
  - `test/`: 工作流单元测试

#### `nodes-base/`
- **功能**: n8n 内置的基础节点集合
- **主要文件**:
  - `credentials/`: 各种服务的认证凭据定义
  - `nodes/`: 各种服务的节点实现（HTTP、Email、Database 等）
  - `utils/`: 节点通用工具函数

#### `frontend/`
- **功能**: 前端应用和编辑器
- **主要文件**:
  - `editor-ui/`: 主要的可视化工作流编辑器
  - `AGENTS.md`: AI Agent 前端相关文档

#### `extensions/`
- **功能**: n8n 扩展功能
- **主要文件**:
  - `insights/`: 数据洞察功能

#### `testing/`
- **功能**: 测试工具和框架
- **主要文件**:
  - `containers/`: 测试容器配置
  - `playwright/`: E2E 测试套件

### 内部共享包 (@n8n/*)

#### `@n8n/api-types/`
- **功能**: API 类型定义和接口描述

#### `@n8n/backend-common/`
- **功能**: 后端通用工具和基础功能

#### `@n8n/config/`
- **功能**: 全局配置管理

#### `@n8n/constants/`
- **功能**: 常量定义

#### `@n8n/db/`
- **功能**: 数据库操作和模型定义

#### `@n8n/di/`
- **功能**: 依赖注入容器

#### `@n8n/errors/`
- **功能**: 错误处理和定义

#### `@n8n/permissions/`
- **功能**: 权限管理系统

#### `@n8n/utils/`
- **功能**: 通用工具函数

#### `@n8n/nodes-langchain/`
- **功能**: AI 和 LangChain 相关节点

#### `@n8n/ai-workflow-builder.ee/`
- **功能**: AI 工作流构建器（企业版）

#### `@n8n/backend-test-utils/`
- **功能**: 后端测试工具和辅助函数

#### `@n8n/create-node/`
- **功能**: 创建新节点的工具

#### `@n8n/extension-sdk/`
- **功能**: 扩展 SDK

#### `@n8n/task-runner/`
- **功能**: 任务运行器

#### `@n8n/task-runner-python/`
- **功能**: Python 任务运行器

## scripts 目录

- `build-n8n.mjs`: 构建 n8n 应用的脚本
- `reset.mjs`: 重置开发环境的脚本
- `format.mjs`: 代码格式化脚本
- `dockerize-n8n.mjs`: 将 n8n 打包成 Docker 镜像的脚本
- `backend-module/`: 后端模块相关脚本

## shell 目录

- `manage_n8n.ps1`: Windows PowerShell 管理脚本
- `start_n8n.bat`: Windows 启动脚本
- `stop_n8n.bat`: Windows 停止脚本
- `quick_start_n8n.bat`: Windows 快速启动脚本
- `n8n_structure.md`: n8n 结构说明文档