# n8n 启动文档

## 项目启动命令详解

### 开发环境启动

#### `pnpm dev`
- **功能**: 并行启动整个开发环境（后端和前端编辑器）
- **作用**: 同时运行 CLI 后端服务和前端编辑器，支持热重载
- **排除**: 不包括 @n8n/design-system、@n8n/chat、@n8n/task-runner

#### `pnpm dev:be`
- **功能**: 仅启动后端开发环境
- **作用**: 运行 CLI 后端服务，不启动前端编辑器
- **适用场景**: 当你只需要调试后端逻辑时

#### `pnpm dev:fe:editor`
- **功能**: 仅启动前端编辑器开发环境
- **作用**: 运行前端编辑器，不启动后端服务
- **适用场景**: 当你只需要调试前端界面时

#### `pnpm dev:ai`
- **功能**: 启动 AI 相关开发环境
- **作用**: 运行 AI 节点、n8n 主应用和核心服务
- **适用场景**: 当你开发 AI 相关功能时

#### `pnpm dev:e2e`
- **功能**: 启动端到端测试开发环境
- **作用**: 启动 Playwright E2E 测试环境带 UI 界面

### 生产环境启动

#### `pnpm start`
- **功能**: 启动 n8n 应用
- **作用**: 运行编译后的 n8n 应用
- **原理**: 通过 `run-script-os` 跨平台运行相应命令
  - Linux/macOS: `cd packages/cli/bin && ./n8n`
  - Windows: `cd packages/cli/bin && n8n`

#### `pnpm run start:default` 和 `pnpm run start:windows`
- **功能**: 平台特定的启动命令
- **作用**: 针对不同操作系统调整启动方式

### 专用启动命令

#### `pnpm run webhook`
- **功能**: 启动 n8n webhook 服务
- **作用**: 专门处理 webhook 请求的服务

#### `pnpm run worker`
- **功能**: 启动 n8n worker 服务
- **作用**: 专门处理后台任务的工作进程
- **适用场景**: 在分布式部署中处理工作流执行

### 构建命令

#### `pnpm build`
- **功能**: 构建整个项目
- **作用**: 使用 Turbo 并行构建所有包
- **输出**: 编译后的 JavaScript 文件

#### `pnpm build:n8n`
- **功能**: 构建 n8n 应用
- **作用**: 使用专用脚本构建 n8n 应用

#### `pnpm build:docker`
- **功能**: 构建 Docker 镜像
- **作用**: 先构建 n8n 应用，然后打包成 Docker 镜像

### 测试命令

#### `pnpm test`
- **功能**: 运行所有测试
- **作用**: 使用 Turbo 运行所有包的测试

#### `pnpm test:ci`
- **功能**: 运行 CI 环境测试
- **作用**: 在持续集成环境中运行测试，继续执行即使有错误

#### `pnpm test:ci:backend` 和 `pnpm test:ci:frontend`
- **功能**: 分别运行后端和前端测试
- **作用**: 可以分别测试不同部分

### 其他常用命令

#### `pnpm clean`
- **功能**: 清理构建产物
- **作用**: 清理所有包的构建缓存和输出

#### `pnpm reset`
- **功能**: 重置开发环境
- **作用**: 清理依赖和构建产物，重置到初始状态

#### `pnpm lint`
- **功能**: 代码检查
- **作用**: 检查代码规范和潜在错误

#### `pnpm format`
- **功能**: 格式化代码
- **作用**: 使用 Biome 和其他工具格式化所有代码

## 启动流程说明

### 默认启动流程 (`pnpm start`)
1. 进入 `packages/cli/bin` 目录
2. 执行 `n8n` 命令
3. 加载配置文件
4. 初始化数据库连接
5. 启动 Web 服务器
6. 监听指定端口（默认 5678）

### 开发模式启动流程 (`pnpm dev`)
1. 使用 Turbo 并行运行后端和前端的开发命令
2. 后端：启动 CLI 服务并监听文件变化
3. 前端：启动开发服务器并启用热重载
4. 建立后端 API 代理以转发请求

## 环境变量配置

启动 n8n 时，可以通过环境变量进行配置：

- `N8N_PORT`: 指定 n8n 服务端口（默认 5678）
- `N8N_HOST`: 指定绑定的主机地址（默认 localhost）
- `NODE_ENV`: 指定运行环境（development/production）
- `DB_TYPE`: 指定数据库类型（SQLite/postgres/mysql）
- `N8N_BASIC_AUTH_ACTIVE`: 启用基本认证
- `N8N_BASIC_AUTH_USER` 和 `N8N_BASIC_AUTH_PASSWORD`: 基本认证凭据
- `N8N_SMTP_*`: 邮件服务配置相关变量
- `EXECUTIONS_MODE`: 执行模式（regular/queue）
- `REDIS_HOST` 和 `REDIS_PORT`: Redis 配置（队列模式下需要）